(this["webpackJsonpbangumi-ratings"]=this["webpackJsonpbangumi-ratings"]||[]).push([[0],{174:function(e,t){e.exports={APPLICATION_ID:"54T0X4tWovUBdnRd6EKdW3BrN4WJrpGBEJdwDk9J",JAVASCRIPT_KEY:"WREbi60D2GfVknGhH9Je1GJ931oIhIVkHUXD9u5R",SERVER_URL:"https://parseapi.back4app.com/"}},358:function(e,t,a){},359:function(e,t,a){},586:function(e,t){},588:function(e,t){},599:function(e,t){},601:function(e,t){},628:function(e,t){},630:function(e,t){},631:function(e,t){},636:function(e,t){},638:function(e,t){},657:function(e,t){},669:function(e,t){},672:function(e,t){},718:function(e,t,a){},719:function(e,t,a){},72:function(e,t,a){},720:function(e,t,a){},721:function(e,t,a){},722:function(e,t,a){},723:function(e,t,a){},724:function(e,t,a){},725:function(e,t,a){},727:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),l=a(114),c=a.n(l),u=(a(358),a(71)),i=a.n(u),o=a(146),s=a(13),m=a(119),d=a(225),f=Object(n.createContext)(null);function E(){return Object(n.useContext)(f)}a(359),a(72);function p(){var e=E(),t=e.authenticated,a=e.setAuthenticating,n=e.handleSignOut;return t?r.a.createElement("div",{id:"user-management"},r.a.createElement("div",{className:"text-button clickable",onClick:n},"\u6ce8\u9500")):r.a.createElement("div",{className:"text-button clickable",onClick:function(){return a(!0)}},"\u767b\u9646")}var b=function(e){return r.a.createElement(d.a,{sticky:"top",expand:"lg",id:"navbar"},r.a.createElement(d.a.Brand,{href:"/"},"\u8ffd\u756a\u8865\u756a"),r.a.createElement(m.a,{className:"mr-auto",activeKey:window.location.pathname},r.a.createElement(m.a.Item,null,r.a.createElement(m.a.Link,{onClick:function(){return e.switchPage("AnimeList")}},"\u6211\u7684\u5217\u8868")),r.a.createElement(m.a.Item,null,r.a.createElement(m.a.Link,{onClick:function(){return e.switchPage("MonthlySummary")}},"\u6bcf\u6708\u603b\u7ed3"))),r.a.createElement(p,null))},v={ratings:[],summaries:{}},g=r.a.createContext(v),h=a(50),y=a.n(h),_=a(174),O=a(353),j=a(36),k=a(45),w=a(352),N=a(144);function S(e){return r.a.createElement("th",{key:e.header},r.a.createElement("div",{className:"table-header"},r.a.createElement("div",null,e.header),r.a.createElement(N.b,{className:"icon clickable",onClick:e.sort})))}var C=a(116);a(718);function L(e){var t=Object(n.useState)(!1),a=Object(s.a)(t,2),l=a[0],c=a[1];return l?r.a.createElement("div",{className:"filter-box"},r.a.createElement("input",{className:"filter-input-box",placeholder:"\u8f93\u5165......",type:"text",onKeyPress:function(t){"Enter"===t.key&&e.filter(t)}}),r.a.createElement("div",{className:"close-button clickable",onClick:function(){e.clearFilter(),c(!l)}},"\xd7")):r.a.createElement(C.a,{className:"filter-box icon clickable",onClick:function(){return c(!l)}})}a(719);function V(e){return r.a.createElement("th",{key:e.header},r.a.createElement("div",{className:"table-header"},r.a.createElement("div",null,e.header),r.a.createElement(L,{filter:e.filter,clearFilter:e.clearFilter})))}a(720);function Y(e){return r.a.createElement("th",{key:e.header},r.a.createElement("select",{id:"status",className:"dropdown-header",name:"status",onChange:function(t){return e.filterStatus(t)}},r.a.createElement("option",{value:"",selected:!0},"\u72b6\u6001"),r.a.createElement("option",{value:"\u60f3\u770b"},"\u60f3\u770b"),r.a.createElement("option",{value:"\u5728\u770b"},"\u5728\u770b"),r.a.createElement("option",{value:"\u5df2\u770b"},"\u5df2\u770b")))}a(721);function I(e){var t=e.description;return void 0===t||null===t?r.a.createElement("p",null,"\u6682\u65e0\u7b80\u4ecb"):r.a.createElement("div",{className:"description"},r.a.createElement("div",null,r.a.createElement("h1",null,t.name,r.a.createElement("a",{href:"https://www.douban.com/search?q="+t.name,target:"_blank",rel:"noopener noreferrer"},r.a.createElement(C.a,{className:"icon clickable"}))),r.a.createElement("p",null,"\u8c46\u74e3\u8bc4\u5206\uff1a",t.douban),r.a.createElement("p",null,"\u5e74\u4efd\uff1a",t.year),r.a.createElement("p",null,"\u5206\u7c7b\uff1a",t.genre),r.a.createElement("p",null,"\u96c6\u6570\uff1a",t.episodes),r.a.createElement("p",null,"\u5355\u96c6\u7247\u957f\uff1a",t.episode_length),r.a.createElement("p",null,"\u7b80\u4ecb\uff1a",t.description)))}var x=a(7),D=a(31);a(722);function M(e){var t=void 0===e.oldValue||null===e.oldValue?{}:e.oldValue;return r.a.createElement(x.a,{onSubmit:function(t){e.onSubmitOrEdit(t,e.id)}},r.a.createElement(x.a.Group,{controlId:"name"},r.a.createElement(x.a.Label,null,"\u540d\u79f0"),r.a.createElement(x.a.Control,{defaultValue:t.name,type:"input"})),r.a.createElement(x.a.Group,null,r.a.createElement(x.a.Row,{className:"input-row"},r.a.createElement(D.a,null,r.a.createElement(x.a.Label,null,"\u8c46\u74e3\u8bc4\u5206",r.a.createElement("a",{href:"https://www.douban.com",target:"_blank",rel:"noopener noreferrer"},r.a.createElement(C.a,{className:"icon clickable"}))),r.a.createElement(x.a.Control,{defaultValue:t.douban,id:"douban",type:"input"})),r.a.createElement(D.a,null,r.a.createElement(x.a.Label,null,"\u5e74\u4efd"),r.a.createElement(x.a.Control,{defaultValue:t.year,id:"year",type:"input"})),r.a.createElement(D.a,null,r.a.createElement(x.a.Label,null,"\u72b6\u6001"),r.a.createElement(x.a.Control,{defaultValue:t.status,id:"status",type:"input"}))),r.a.createElement(x.a.Row,{className:"input-row"},r.a.createElement(D.a,null,r.a.createElement(x.a.Label,null,"\u5206\u7c7b"),r.a.createElement(x.a.Control,{defaultValue:t.genre,id:"genre",type:"input"})),r.a.createElement(D.a,null,r.a.createElement(x.a.Label,null,"TV\u96c6\u6570"),r.a.createElement(x.a.Control,{defaultValue:t.tv_episodes,id:"tv_episodes",type:"input"})),r.a.createElement(D.a,null,r.a.createElement(x.a.Label,null,"\u5267\u573a\u7248"),r.a.createElement(x.a.Control,{defaultValue:t.movies,id:"movies",type:"input"})),r.a.createElement(D.a,null,r.a.createElement(x.a.Label,null,"\u5355\u96c6\u7247\u957f"),r.a.createElement(x.a.Control,{defaultValue:t.episode_length,id:"episode_length",type:"input"})))),r.a.createElement(x.a.Group,null,r.a.createElement(x.a.Label,null,"\u7b80\u4ecb"),r.a.createElement(x.a.Control,{defaultValue:t.description,id:"description",as:"textarea",rows:"3"})),r.a.createElement(x.a.Group,null,r.a.createElement(x.a.Row,{className:"input-row"},r.a.createElement(D.a,null,r.a.createElement(x.a.Label,null,"\u5267\u60c5\u8bc4\u5206"),r.a.createElement(x.a.Control,{defaultValue:t.story,id:"story",type:"input"})),r.a.createElement(D.a,null,r.a.createElement(x.a.Label,null,"\u4f5c\u753b\u8bc4\u5206"),r.a.createElement(x.a.Control,{defaultValue:t.story,id:"illustration",type:"input"})),r.a.createElement(D.a,null,r.a.createElement(x.a.Label,null,"\u97f3\u4e50\u8bc4\u5206"),r.a.createElement(x.a.Control,{defaultValue:t.music,id:"music",type:"input"})),r.a.createElement(D.a,null,r.a.createElement(x.a.Label,null,"\u60c5\u6000\u8bc4\u5206"),r.a.createElement(x.a.Control,{defaultValue:t.passion,id:"passion",type:"input"})))),r.a.createElement(x.a.Group,null,r.a.createElement(x.a.Row,{className:"input-row"},r.a.createElement(D.a,null,r.a.createElement(x.a.Label,null,"\u5f00\u59cb\u89c2\u770b\u65e5\u671f"),r.a.createElement(x.a.Control,{defaultValue:t.start_date,id:"start_date",type:"input"})),r.a.createElement(D.a,null,r.a.createElement(x.a.Label,null,"\u7ed3\u675f\u89c2\u770b\u65e5\u671f"),r.a.createElement(x.a.Control,{defaultValue:t.end_date,id:"end_date",type:"input"})),r.a.createElement(D.a,null,r.a.createElement(x.a.Label,null,"\u89c2\u770b\u6b21\u6570"),r.a.createElement(x.a.Control,{defaultValue:t.times_watched,id:"times_watched",type:"input"})))),r.a.createElement(k.a,{className:"pink-button",type:"submit"},"\u63d0\u4ea4"))}function A(e){return isNaN(e)?"-":e>=60?Math.round(e/60*10)/10+" \u5c0f\u65f6":Math.round(10*e)/10+" \u5206\u949f"}function R(e){var t=e.end_date.diff(e.start_date,"days")+1,a=void 0===e.episode_length||0===e.episode_length?24:e.episode_length;return(e.tv_episodes*a+90*e.movies)/t}function P(e){switch(e){case"\u540d\u79f0":return"name";case"\u96c6\u6570":return"tv_episodes";case"\u72b6\u6001":return"status";case"\u5206\u7c7b":return"genre";case"\u5267\u60c5":return"story";case"\u4f5c\u753b":return"illustration";case"\u97f3\u4e50":return"music";case"\u60c5\u6000":return"passion";case"\u8bc4\u5206":return"rating";case"\u9996\u6b21\u89c2\u770b\u65e5\u671f":return"end_date";case"\u89c2\u770b\u6b21\u6570":return"times_watched";case"\u5e74\u4efd":return"year";case"\u8c46\u74e3\u8bc4\u5206":return"douban";case"\u65e5\u5747\u65f6\u957f":return"daily_time";default:return"unknown"}}function J(e,t){return e.slice().sort((function(e,a){var n="daily_time"===t?R(e):e[t],r="daily_time"===t?R(a):a[t];return"start_date"===t?n.isValid()?r.isValid()?B(n,r):-1:1:B(n,r)}))}function B(e,t){return e>t?-1:e<t?1:0}a(723);y.a.initialize(_.APPLICATION_ID,_.JAVASCRIPT_KEY),y.a.serverURL=_.SERVER_URL;var F=function(e){var t=E().authenticated,a=r.a.useContext(g).ratings,l=["\u5e8f\u53f7","\u540d\u79f0","\u96c6\u6570","\u5206\u7c7b","\u5267\u60c5","\u4f5c\u753b","\u97f3\u4e50","\u60c5\u6000","\u8bc4\u5206","\u9996\u6b21\u89c2\u770b\u65e5\u671f","\u65e5\u5747\u65f6\u957f",""],c=["\u5e8f\u53f7","\u540d\u79f0","\u96c6\u6570","\u5206\u7c7b","\u5e74\u4efd","\u8c46\u74e3\u8bc4\u5206","\u7b80\u4ecb",""],u=Object(n.useState)(null),i=Object(s.a)(u,2),o=i[0],m=i[1],d=Object(n.useState)(!1),f=Object(s.a)(d,2),p=f[0],b=f[1],v=Object(n.useState)(!1),h=Object(s.a)(v,2),y=h[0],_=h[1],C=Object(n.useState)(!1),L=Object(s.a)(C,2),x=L[0],D=L[1],B=Object(n.useState)(!1),F=Object(s.a)(B,2),G=F[0],T=F[1],H=Object(n.useState)({}),U=Object(s.a)(H,2),z=U[0],W=U[1],K=Object(n.useState)(),Q=Object(s.a)(K,2),X=Q[0],q=Q[1],$=Object(n.useState)("\u5df2\u770b"),Z=Object(s.a)($,2),ee=Z[0],te=Z[1],ae=Object(n.useState)(a),ne=Object(s.a)(ae,2),re=ne[0],le=ne[1],ce=Object(n.useState)(l),ue=Object(s.a)(ce,2),ie=ue[0],oe=ue[1],se=Object(n.useState)({}),me=Object(s.a)(se,2),de=me[0],fe=me[1],Ee=Object(n.useState)(),pe=Object(s.a)(Ee,2),be=pe[0],ve=pe[1],ge=Object(n.useState)(null),he=Object(s.a)(ge,2),ye=he[0],_e=he[1];Object(n.useEffect)((function(){ve("end_date")}),[]),Object(n.useEffect)((function(){fe([]),le(J(a.filter((function(e){return e.status===ee})),"end_date"))}),[e.isLoading,a,ee]),Object(n.useEffect)((function(){null!==be&&(le(J(a.filter((function(e){return e.status===ee})),be)),ve(null))}),[be,a,ee]),Object(n.useEffect)((function(){if(0!==de.length){for(var e=function(){var e=Object(s.a)(n[t],2),r=e[0],l=e[1];le(a.filter((function(e){return e[r].includes(l)&&e.status===ee})))},t=0,n=Object.entries(de);t<n.length;t++)e();fe([])}}),[a,de,ee]);var Oe=function(e){var t=e.target.innerHTML;oe("\u60f3\u770b"===t?c:l),te(t)};return e.isLoading?r.a.createElement("div",{className:"loading"},r.a.createElement("div",null,"\u6b63\u5728\u52a0\u8f7d......")):e.loadError?r.a.createElement(w.a,{variant:"danger"},"\u756a\u5267\u8bc4\u5206\u52a0\u8f7d\u5931\u8d25\uff01"):r.a.createElement("div",{className:"main-element"},r.a.createElement(j.a,{centered:!0,size:"lg",show:p,onHide:function(){return b(!1)}},r.a.createElement(j.a.Header,null,r.a.createElement(j.a.Title,null,"\u7b80\u4ecb")),r.a.createElement(j.a.Body,null,r.a.createElement(I,{description:o})),r.a.createElement(j.a.Footer,null,r.a.createElement(k.a,{className:"pink-button",onClick:function(){return b(!1)}},"\u5173\u95ed"))),r.a.createElement(j.a,{centered:!0,size:"lg",show:y,onHide:function(){return _(!1)}},r.a.createElement(j.a.Header,{closeButton:!0},r.a.createElement(j.a.Title,null,G?"\u6dfb\u52a0\u65b0\u756a\u5267":"\u7f16\u8f91\u756a\u5267")),r.a.createElement(j.a.Body,null,r.a.createElement(M,{onSubmitOrEdit:function(t,a){G?(t.preventDefault(),e.onAnimeSubmit(t,null,!0),_(!1)):(t.preventDefault(),e.onAnimeSubmit(t,a,!1),_(!1))},oldValue:ye,id:X}))),r.a.createElement(j.a,{centered:!0,size:"sm",show:x,onHide:function(){return D(!1)}},r.a.createElement(j.a.Header,{closeButton:!0},r.a.createElement(j.a.Title,null,"\u5220\u9664\u756a\u5267")),r.a.createElement(j.a.Body,null,r.a.createElement("p",null,"\u786e\u5b9a\u8981\u5220\u9664\u756a\u5267\u201c".concat(z.name,"\u201d\u5417"))),r.a.createElement(j.a.Footer,null,r.a.createElement(k.a,{variant:"primary",onClick:function(){W({}),D(!1)}},"\u53d6\u6d88"),r.a.createElement(k.a,{variant:"danger",onClick:function(){e.deleteAnime(z.id),W({}),D(!1)}},"\u786e\u5b9a"))),r.a.createElement("div",{className:"button-group"},r.a.createElement("div",null,r.a.createElement(k.a,{className:"pink-button",onClick:Oe},"\u5df2\u770b"),r.a.createElement(k.a,{className:"pink-button",onClick:Oe},"\u5728\u770b"),r.a.createElement(k.a,{className:"pink-button",onClick:Oe},"\u60f3\u770b")),r.a.createElement("div",null,t?r.a.createElement(k.a,{className:"pink-button",onClick:function(){_e(null),q(null),_(!0),T(!0)}},"\u6dfb\u52a0"):r.a.createElement(r.a.Fragment,null),r.a.createElement(k.a,{className:"pink-button",onClick:e.refresh},"\u5237\u65b0"))),r.a.createElement("div",null,r.a.createElement(O.a,{striped:!0,borderless:!0,hover:!0,size:"sm",variant:"light",id:"table"},r.a.createElement("thead",null,r.a.createElement("tr",{className:"table-headers"},ie.map((function(e){return"\u540d\u79f0"===e||"\u5206\u7c7b"===e?r.a.createElement(V,{key:e,header:e,filter:function(t){var a={};for(var n in de)a[n]=de[n];a[P(e)]=t.target.value,fe(a)},clearFilter:function(){fe([]),le(J(a.filter((function(e){return e.status===ee})),"end_date"))}}):"\u72b6\u6001"===e?r.a.createElement(Y,{key:e,header:e,filterStatus:function(e){fe({status:e.target.value})}}):""!==e?r.a.createElement(S,{key:e,header:e,sort:function(){return ve(P(e))}}):r.a.createElement("th",{key:e})})))),r.a.createElement("tbody",null,re.map((function(e,a){return r.a.createElement("tr",{key:e.name},r.a.createElement("td",null,a+1),r.a.createElement("td",{className:"anime-name clickable",onClick:function(t){m({name:e.name,douban:e.douban,year:e.year,genre:e.genre,episodes:e.tv_episodes,episode_length:e.episode_length,description:e.description}),b(!0)}},e.name),r.a.createElement("td",null,(c=e.tv_episodes,u=e.movies,void 0===c||void 0===u?"":0===c?"\u5267\u573a\u7248\xd7".concat(u):0===u?"".concat(c,"\u96c6"):"".concat(c,"\u96c6+\u5267\u573a\u7248\xd7").concat(u))),r.a.createElement("td",null,e.genre),r.a.createElement("td",null,"\u60f3\u770b"===ee?e.year:e.story),r.a.createElement("td",null,"\u60f3\u770b"===ee?e.douban:e.illustration),r.a.createElement("td",null,"\u60f3\u770b"===ee?function(e){if(null!==e&&void 0!==e)return e.substring(0,20)+"......"}(e.description):e.music),"\u60f3\u770b"===ee?"":r.a.createElement("td",null,e.passion),"\u60f3\u770b"===ee?"":r.a.createElement("td",null,e.rating),"\u60f3\u770b"===ee?"":r.a.createElement("td",null,(n=e.start_date,l=e.end_date,n.isValid()?l.isValid()?"".concat(n.format("MM/DD/YY")," \u81f3 ").concat(l.format("MM/DD/YY")):"".concat(n.format("MM/DD/YY"),"\u81f3\u4eca"):"")),"\u60f3\u770b"===ee?"":r.a.createElement("td",null,A(R(e))),r.a.createElement("td",null," ",t?r.a.createElement(r.a.Fragment,null,r.a.createElement(N.a,{className:"clickable",onClick:function(){q(e.id),_e({name:e.name,year:e.year,douban:e.douban,tv_episodes:e.tv_episodes,movies:e.movies,episode_length:e.episode_length,status:e.status,genre:e.genre,description:e.description,story:e.story,illustration:e.illustration,music:e.music,passion:e.passion,start_date:e.start_date.format("YYYY-MM-DD"),end_date:e.end_date.format("YYYY-MM-DD"),times_watched:e.times_watched}),T(!1),_(!0)}}),r.a.createElement(N.c,{className:"icon clickable",onClick:function(){W({name:e.name,id:e.id}),D(!0)}})):r.a.createElement(r.a.Fragment,null)));var n,l,c,u}))))))},G=a(85),T=a.n(G);a(724);function H(e){return r.a.createElement("div",{className:"summary"},r.a.createElement("div",{className:"month"},T()(e.month).format("YYYY[\u5e74]MM[\u6708]")),r.a.createElement("div",{className:"bangumi-num"},"\u756a\u5267\u603b\u6570\uff1a"+e.summary.bangumi_num),r.a.createElement("div",null,"\u603b\u96c6\u6570\uff1a"+e.summary.tv_episode_num),r.a.createElement("div",null,"\u603b\u65f6\u957f\uff1a"+e.summary.total_time),r.a.createElement("div",null,"\u6bcf\u65e5\u65f6\u957f\uff1a"+A(e.summary.total_time/T()(e.month).daysInMonth())),r.a.createElement("div",null,"\u756a\u5267\u5217\u8868\uff1a"+e.summary.bangumis.join(", ")))}var U=function(){var e=r.a.useContext(g).summaries;return r.a.createElement("div",{className:"main-element monthly-summary"},Object.keys(e).map((function(t){return r.a.createElement(H,{month:t,summary:e[t]})})))};a(725);function z(){var e=E(),t=e.username,a=e.password,n=e.setUsername,l=e.setPassword,c=e.handleLogin;return r.a.createElement("div",{className:"Login"},r.a.createElement(x.a,{onSubmit:c},r.a.createElement(x.a.Group,{size:"lg",controlId:"username"},r.a.createElement(x.a.Label,null,"\u7528\u6237\u540d"),r.a.createElement(x.a.Control,{autoFocus:!0,type:"username",value:t,onChange:function(e){return n(e.target.value)}})),r.a.createElement(x.a.Group,{size:"lg",controlId:"password"},r.a.createElement(x.a.Label,null,"\u5bc6\u7801"),r.a.createElement(x.a.Control,{type:"password",value:a,onChange:function(e){return l(e.target.value)}})),r.a.createElement(k.a,{className:"pink-button",block:!0,size:"lg",type:"submit",disabled:!(t.length>0&&a.length>0)},"\u767b\u9646")))}a(726);var W=function(){var e=Object(n.useState)(!1),t=Object(s.a)(e,2),a=t[0],l=t[1],c=Object(n.useState)(!1),u=Object(s.a)(c,2),m=u[0],d=u[1],E=Object(n.useState)(""),p=Object(s.a)(E,2),v=p[0],h=p[1],_=Object(n.useState)(""),O=Object(s.a)(_,2),j=O[0],k=O[1],w=Object(n.useState)(function(){var e=sessionStorage.getItem("user");return e?JSON.parse(e):null}()),N=Object(s.a)(w,2),S=N[0],C=N[1],L=Object(n.useState)(sessionStorage.getItem("token")||null),V=Object(s.a)(L,2),Y=V[0],I=V[1],x=Object(n.useState)(!0),D=Object(s.a)(x,2),M=D[0],A=D[1],R=Object(n.useState)(!1),P=Object(s.a)(R,2),B=P[0],G=P[1],H=Object(n.useState)("AnimeList"),W=Object(s.a)(H,2),K=W[0],Q=W[1],X=Object(n.useState)([]),q=Object(s.a)(X,2),$=q[0],Z=q[1],ee=Object(n.useState)({}),te=Object(s.a)(ee,2),ae=te[0],ne=te[1],re=function(){var e=Object(o.a)(i.a.mark((function e(){var t,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:A(!0),t=y.a.Object.extend("Ratings"),(a=new y.a.Query(t)).limit(1e3),a.find().then((function(e){if(console.log("calling server"),"undefined"!==typeof document){var t=e.map((function(e){return{id:e.id,name:e.get("name"),year:e.get("year"),douban:e.get("douban"),tv_episodes:e.get("tv_episodes"),movies:e.get("movies"),episode_length:e.get("episode_length"),status:e.get("status"),genre:e.get("genre"),description:e.get("description"),story:e.get("story"),illustration:e.get("illustration"),music:e.get("music"),passion:e.get("passion"),rating:Number((e.get("story")+e.get("illustration")+e.get("music")+e.get("passion")).toFixed(1)),start_date:T()(e.get("start_date"),"YYYY-MM-DD"),end_date:T()(e.get("end_date"),"YYYY-MM-DD"),times_watched:e.get("times_watched")}}));Z(J(t,"start_date")),A(!1)}}),(function(e){A(!1),G(!0),"undefined"!==typeof document&&document.write("Error while fetching ParseObjects: ".concat(JSON.stringify(e))),console.error("Error while fetching ParseObjects",e)}));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),le=function(){var e=Object(o.a)(i.a.mark((function e(t){var a,n,r,l,c,u,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a=y.a.Object.extend("Ratings"),n=new a,r=0,l=Object.entries(t);r<l.length;r++)c=Object(s.a)(l[r],2),u=c[0],o=c[1],n.set(u,o);n.save().then((function(e){alert("\u5df2\u63d0\u4ea4\u66f4\u65b0\uff01"),re()}),(function(e){alert("\u66f4\u65b0\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\u3002")}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ce=function(){var e=Object(o.a)(i.a.mark((function e(t,a){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=y.a.Object.extend("Ratings"),new y.a.Query(n).get(t).then((function(e){for(var t=0,n=Object.entries(a);t<n.length;t++){var r=Object(s.a)(n[t],2),l=r[0],c=r[1];e.set(l,c)}e.save().then((function(e){alert("\u5df2\u63d0\u4ea4\u66f4\u65b0\uff01"),re()}),(function(e){alert("\u66f4\u65b0\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\u3002")}))}));case 3:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),ue=function(){var e=Object(o.a)(i.a.mark((function e(t){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=y.a.Object.extend("Ratings"),new y.a.Query(a).get(t).then((function(e){e.destroy().then((function(e){alert("\u5df2\u5220\u9664\u756a\u5267\uff01"),re()}),(function(e){alert("\u5220\u9664\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\u3002")}))}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){re()}),[]),Object(n.useEffect)((function(){for(var e={},t=0;t<12;t++){var a=T()().subtract(t,"months").startOf("month");e[a]={bangumi_num:0,tv_episode_num:0,movie_num:0,total_time:0,daily_time:0,bangumis:[]}}$.filter((function(e){return"\u5df2\u770b"===e.status})).forEach((function(t){for(var a=T()(t.end_date),n=0,r=Object.entries(e);n<r.length;n++){var l=Object(s.a)(r[n],2),c=l[0],u=l[1];a.isSame(c,"month")&&a.isSameOrAfter(c)&&(u.bangumi_num+=1,u.bangumis.push(t.name),u.tv_episode_num+=t.tv_episodes,u.movie_num+=t.movies,u.total_time+=t.tv_episodes*t.episode_length+90*t.movies)}})),ne(e)}),[$]),Object(n.useEffect)((function(){null!=S&&null!=Y&&l(!0)}),[S,Y]);var ie=function(e,t,a){e.preventDefault();var n=e.target.elements,r={name:n.name.value,year:n.year.value,douban:Number(n.douban.value),tv_episodes:Number(n.tv_episodes.value),movies:Number(n.movies.value),episode_length:Number(n.episode_length.value),status:n.status.value,genre:n.genre.value,description:n.description.value,story:Number(n.story.value),illustration:Number(n.illustration.value),music:Number(n.music.value),passion:Number(n.passion.value),start_date:n.start_date.value,end_date:n.end_date.value,times_watched:Number(n.times_watched.value)};a?le(r):ce(t,r)};return r.a.createElement("div",null,r.a.createElement("div",{className:"App"},r.a.createElement(f.Provider,{value:{username:v,password:j,authenticated:a,setAuthenticating:d,handleLogin:function(e){e.preventDefault(),y.a.User.logIn(v,j).then((function(e){!function(e,t){sessionStorage.setItem("token",t),sessionStorage.setItem("user",JSON.stringify(e))}(e,e.getSessionToken()),alert("\u6b22\u8fce\uff0c"+e.getUsername()),d(!1),l(!0)})).catch((function(e){alert(e.message)}))},handleSignOut:function(){C(null),I(null),sessionStorage.removeItem("token"),sessionStorage.removeItem("user"),l(!1)},setUsername:h,setPassword:k}},r.a.createElement(b,{switchPage:Q}),m?r.a.createElement(z,null):r.a.createElement(g.Provider,{value:{ratings:$,summaries:ae}},function(e){switch(e){case"AnimeList":return r.a.createElement(F,{isLoading:M,loadError:B,refresh:re,onAnimeSubmit:ie,deleteAnime:ue});case"MonthlySummary":return r.a.createElement(U,null);default:return r.a.createElement(F,{isLoading:M,loadError:B,refresh:re,onAnimeSubmit:ie,deleteAnime:ue})}}(K)))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(W,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[727,1,2]]]);
//# sourceMappingURL=main.e088fa94.chunk.js.map