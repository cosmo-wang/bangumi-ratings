(this["webpackJsonpbangumi-ratings"]=this["webpackJsonpbangumi-ratings"]||[]).push([[0],{180:function(e,t){e.exports={APPLICATION_ID:"54T0X4tWovUBdnRd6EKdW3BrN4WJrpGBEJdwDk9J",JAVASCRIPT_KEY:"WREbi60D2GfVknGhH9Je1GJ931oIhIVkHUXD9u5R",SERVER_URL:"https://parseapi.back4app.com/"}},293:function(e,t,n){},294:function(e,t,n){},299:function(e,t,n){},300:function(e,t,n){},301:function(e,t,n){},303:function(e,t,n){},304:function(e,t,n){},305:function(e,t,n){},310:function(e,t,n){},311:function(e,t,n){},312:function(e,t,n){},313:function(e,t,n){},314:function(e,t,n){},55:function(e,t,n){},576:function(e,t){},630:function(e,t,n){"use strict";n.r(t);var a=n(1),s=n.n(a),c=n(54),i=n.n(c),r=(n(293),n(34)),o=n.n(r),l=n(60),u=n(6),d=n(180),j=n(67),b=n(209),O=Object(a.createContext)(null);function h(){return Object(a.useContext)(O)}n(294),n(55);var m=n(2);function x(){var e=h(),t=e.authenticated,n=e.setAuthenticating,a=e.handleSignOut;return t?Object(m.jsx)("div",{id:"user-management",children:Object(m.jsx)("div",{className:"text-button clickable",onClick:a,children:"\u6ce8\u9500"})}):Object(m.jsx)("div",{className:"text-button clickable",onClick:function(){return n(!0)},children:"\u767b\u9646"})}var f=function(e){return Object(m.jsxs)(b.a,{sticky:"top",expand:"lg",id:"navbar",children:[Object(m.jsx)(b.a.Brand,{href:"/",children:"\u8ffd\u756a\u8865\u756a"}),Object(m.jsxs)(j.a,{className:"mr-auto",activeKey:window.location.pathname,children:[Object(m.jsx)(j.a.Item,{children:Object(m.jsx)(j.a.Link,{onClick:function(){return e.switchPage("AnimeList")},children:"\u8865\u756a\u5217\u8868"})}),Object(m.jsx)(j.a.Item,{children:Object(m.jsx)(j.a.Link,{onClick:function(){return e.switchPage("NewAnimeList")},children:"\u8ffd\u756a\u5217\u8868"})}),Object(m.jsx)(j.a.Item,{children:Object(m.jsx)(j.a.Link,{onClick:function(){return e.switchPage("MonthlySummary")},children:"\u6bcf\u6708\u603b\u7ed3"})}),Object(m.jsx)(j.a.Item,{children:Object(m.jsx)(j.a.Link,{onClick:function(){return e.switchPage("SeasonalSummary")},children:"\u5b63\u5ea6\u603b\u7ed3"})})]}),Object(m.jsx)(x,{})]})},p={ratings:[],newAnimes:[],monthlySummaries:{}},v=s.a.createContext(p),g=n(177),y=n(11),_=n(16),w=n(4),N=n(174),k=n(59);function S(e){return Object(m.jsx)("th",{children:Object(m.jsxs)("div",{className:"table-header",children:[Object(m.jsx)("div",{children:e.header}),Object(m.jsx)(k.b,{className:"icon clickable",onClick:e.sort})]})},e.header)}var C=n(124);n(299);function A(e){var t=Object(a.useState)(!1),n=Object(u.a)(t,2),s=n[0],c=n[1];return s?Object(m.jsxs)("div",{className:"filter-box",children:[Object(m.jsx)("input",{className:"filter-input-box",placeholder:"\u8f93\u5165......",type:"text",onKeyPress:function(t){"Enter"===t.key&&e.filter(t)}}),Object(m.jsx)("div",{className:"close-button clickable",onClick:function(){e.clearFilter(),c(!s)},children:"\xd7"})]}):Object(m.jsx)(C.a,{className:"filter-box icon clickable",onClick:function(){return c(!s)}})}n(300);function L(e){return Object(m.jsx)("th",{children:Object(m.jsxs)("div",{className:"table-header",children:[Object(m.jsx)("div",{children:e.header}),Object(m.jsx)(A,{filter:e.filter,clearFilter:e.clearFilter})]})},e.header)}n(301);function Y(e){var t=e.description;return void 0===t||null===t?Object(m.jsx)("p",{children:"\u6682\u65e0\u7b80\u4ecb"}):Object(m.jsx)("div",{className:"description",children:Object(m.jsxs)("div",{children:[Object(m.jsxs)("h1",{children:[t.name,Object(m.jsx)("a",{href:"https://www.douban.com/search?q="+t.name,target:"_blank",rel:"noopener noreferrer",children:Object(m.jsx)(C.a,{className:"icon clickable"})})]}),Object(m.jsxs)("p",{children:["\u8c46\u74e3\u8bc4\u5206\uff1a",t.douban]}),Object(m.jsxs)("p",{children:["\u5e74\u4efd\uff1a",t.year]}),Object(m.jsxs)("p",{children:["\u5206\u7c7b\uff1a",t.genre]}),Object(m.jsxs)("p",{children:["\u96c6\u6570\uff1a",t.episodes]}),Object(m.jsxs)("p",{children:["\u5355\u96c6\u7247\u957f\uff1a",t.episode_length]}),Object(m.jsxs)("p",{children:["\u7b80\u4ecb\uff1a",t.description]})]})})}var E=n(20),I=n(31),V=n.n(I);n(303);function D(e){var t=Object(a.useState)({}),n=Object(u.a)(t,2),s=n[0],c=n[1];Object(a.useEffect)((function(){c(null==e.oldValue||void 0===e.oldValue?{}:e.oldValue)}),[e.oldValue]);var i=function(e,t){var n=V()(new Date).format("YYYY-MM-DD"),a=JSON.parse(JSON.stringify(s));e?a.start_date=n:t&&(a.end_date=n),c(a)};return Object(m.jsxs)(w.a,{onSubmit:function(t){e.onSubmitOrEdit(t,e.id)},children:[Object(m.jsxs)(w.a.Group,{controlId:"name",children:[Object(m.jsx)(w.a.Label,{children:"\u540d\u79f0"}),Object(m.jsx)(w.a.Control,{defaultValue:s.name,type:"input"})]}),Object(m.jsxs)(w.a.Group,{children:[Object(m.jsxs)(w.a.Row,{className:"input-row",children:[Object(m.jsxs)(E.a,{children:[Object(m.jsxs)(w.a.Label,{children:["\u8c46\u74e3\u8bc4\u5206",Object(m.jsx)("a",{href:"https://www.douban.com",target:"_blank",rel:"noopener noreferrer",children:Object(m.jsx)(C.a,{className:"icon clickable"})})]}),Object(m.jsx)(w.a.Control,{defaultValue:s.douban,id:"douban",type:"input"})]}),Object(m.jsxs)(E.a,{children:[Object(m.jsx)(w.a.Label,{children:"\u5e74\u4efd"}),Object(m.jsx)(w.a.Control,{defaultValue:s.year,id:"year",type:"input"})]}),Object(m.jsxs)(E.a,{children:[Object(m.jsx)(w.a.Label,{children:"\u72b6\u6001"}),Object(m.jsx)(w.a.Control,{defaultValue:s.status,id:"status",type:"input"})]})]}),Object(m.jsxs)(w.a.Row,{className:"input-row",children:[Object(m.jsxs)(E.a,{children:[Object(m.jsx)(w.a.Label,{children:"\u5206\u7c7b"}),Object(m.jsx)(w.a.Control,{defaultValue:s.genre,id:"genre",type:"input"})]}),Object(m.jsxs)(E.a,{children:[Object(m.jsx)(w.a.Label,{children:"TV\u96c6\u6570"}),Object(m.jsx)(w.a.Control,{defaultValue:s.tv_episodes,id:"tv_episodes",type:"input"})]}),Object(m.jsxs)(E.a,{children:[Object(m.jsx)(w.a.Label,{children:"\u5267\u573a\u7248"}),Object(m.jsx)(w.a.Control,{defaultValue:s.movies,id:"movies",type:"input"})]}),Object(m.jsxs)(E.a,{children:[Object(m.jsx)(w.a.Label,{children:"\u5355\u96c6\u7247\u957f"}),Object(m.jsx)(w.a.Control,{defaultValue:s.episode_length,id:"episode_length",type:"input"})]})]})]}),Object(m.jsxs)(w.a.Group,{children:[Object(m.jsx)(w.a.Label,{children:"\u7b80\u4ecb"}),Object(m.jsx)(w.a.Control,{defaultValue:s.description,id:"description",as:"textarea",rows:"3"})]}),Object(m.jsx)(w.a.Group,{children:Object(m.jsxs)(w.a.Row,{className:"input-row",children:[Object(m.jsxs)(E.a,{children:[Object(m.jsx)(w.a.Label,{children:"\u5267\u60c5\u8bc4\u5206"}),Object(m.jsx)(w.a.Control,{defaultValue:s.story,id:"story",type:"input"})]}),Object(m.jsxs)(E.a,{children:[Object(m.jsx)(w.a.Label,{children:"\u4f5c\u753b\u8bc4\u5206"}),Object(m.jsx)(w.a.Control,{defaultValue:s.story,id:"illustration",type:"input"})]}),Object(m.jsxs)(E.a,{children:[Object(m.jsx)(w.a.Label,{children:"\u97f3\u4e50\u8bc4\u5206"}),Object(m.jsx)(w.a.Control,{defaultValue:s.music,id:"music",type:"input"})]}),Object(m.jsxs)(E.a,{children:[Object(m.jsx)(w.a.Label,{children:"\u60c5\u6000\u8bc4\u5206"}),Object(m.jsx)(w.a.Control,{defaultValue:s.passion,id:"passion",type:"input"})]})]})}),Object(m.jsx)(w.a.Group,{children:Object(m.jsxs)(w.a.Row,{className:"input-row",children:[Object(m.jsxs)(E.a,{children:[Object(m.jsxs)(w.a.Label,{children:["\u5f00\u59cb\u89c2\u770b\u65e5\u671f ",Object(m.jsx)("span",{className:"clickable",onClick:function(){return i(!0,!1)},children:"(\u4eca\u65e5\u65e5\u671f)"})]}),Object(m.jsx)(w.a.Control,{defaultValue:s.start_date,id:"start_date",type:"input"})]}),Object(m.jsxs)(E.a,{children:[Object(m.jsxs)(w.a.Label,{children:["\u7ed3\u675f\u89c2\u770b\u65e5\u671f ",Object(m.jsx)("span",{className:"clickable",onClick:function(){return i(!1,!0)},children:"(\u4eca\u65e5\u65e5\u671f)"})]}),Object(m.jsx)(w.a.Control,{defaultValue:s.end_date,id:"end_date",type:"input"})]}),Object(m.jsxs)(E.a,{children:[Object(m.jsx)(w.a.Label,{children:"\u89c2\u770b\u6b21\u6570"}),Object(m.jsx)(w.a.Control,{defaultValue:s.times_watched,id:"times_watched",type:"input"})]})]})}),Object(m.jsx)(_.a,{className:"pink-button",type:"submit",children:"\u63d0\u4ea4"})]})}function M(e,t){return void 0===e||void 0===t?"":0===e?"\u5267\u573a\u7248\xd7".concat(t):0===t?"".concat(e,"\u96c6"):"".concat(e,"\u96c6+\u5267\u573a\u7248\xd7").concat(t)}function R(e){return isNaN(e)?"-":e>=60?Math.round(e/60*10)/10+" \u5c0f\u65f6":Math.round(10*e)/10+" \u5206\u949f"}function Q(e){var t=e.end_date.diff(e.start_date,"days")+1,n=void 0===e.episode_length||0===e.episode_length?24:e.episode_length;return(e.tv_episodes*n+90*e.movies)/t}function B(e){switch(e){case"\u540d\u79f0":return"name";case"\u96c6\u6570":case"\u9884\u8ba1\u96c6\u6570":return"tv_episodes";case"\u72b6\u6001":return"status";case"\u5206\u7c7b":return"genre";case"\u5267\u60c5":return"story";case"\u4f5c\u753b":return"illustration";case"\u97f3\u4e50":return"music";case"\u60c5\u6000":return"passion";case"\u8bc4\u5206":return"rating";case"\u9996\u6b21\u89c2\u770b\u65e5\u671f":return"end_date";case"\u89c2\u770b\u6b21\u6570":return"times_watched";case"\u5e74\u4efd":return"year";case"\u8c46\u74e3\u8bc4\u5206":return"douban";case"\u65e5\u5747\u65f6\u957f":return"daily_time";case"\u6392\u540d":return"ranking";case"\u5b63\u5ea6":return"season";case"\u5f00\u59cb\u653e\u9001\u65e5\u671f":return"start_date";case"\u66f4\u65b0\u65e5":return"next_episode_day";default:return"unknown"}}function H(e,t){return e.slice().sort((function(e,n){var a="daily_time"===t?Q(e):e[t],s="daily_time"===t?Q(n):n[t];return"start_date"===t&&"string"!==typeof t?a.isValid()?s.isValid()?F(a,s):-1:1:F(a,s)}))}function F(e,t){return e>t?-1:e<t?1:0}function T(e,t){var n={};return e.forEach((function(e){var a=e.seasons_ranking[t],s=Object.keys(a),c=a[s.sort()[s.length-1]];n[e.name]=c})),n}n(304);var q=function(e){var t=h().authenticated,n=s.a.useContext(v).ratings,c=["\u5e8f\u53f7","\u540d\u79f0","\u96c6\u6570","\u5206\u7c7b","\u5267\u60c5","\u4f5c\u753b","\u97f3\u4e50","\u60c5\u6000","\u8bc4\u5206","\u9996\u6b21\u89c2\u770b\u65e5\u671f","\u65e5\u5747\u65f6\u957f",""],i=["\u5e8f\u53f7","\u540d\u79f0","\u96c6\u6570","\u5206\u7c7b","\u5e74\u4efd","\u8c46\u74e3\u8bc4\u5206","\u7b80\u4ecb",""],r=Object(a.useState)(null),o=Object(u.a)(r,2),l=o[0],d=o[1],j=Object(a.useState)(!1),b=Object(u.a)(j,2),O=b[0],x=b[1],f=Object(a.useState)(!1),p=Object(u.a)(f,2),C=p[0],A=p[1],E=Object(a.useState)(!1),I=Object(u.a)(E,2),V=I[0],F=I[1],T=Object(a.useState)(!1),q=Object(u.a)(T,2),P=q[0],z=q[1],G=Object(a.useState)(!1),J=Object(u.a)(G,2),U=J[0],W=J[1],K=Object(a.useState)(!1),X=Object(u.a)(K,2),$=X[0],Z=X[1],ee=Object(a.useState)({}),te=Object(u.a)(ee,2),ne=te[0],ae=te[1],se=Object(a.useState)(),ce=Object(u.a)(se,2),ie=ce[0],re=ce[1],oe=Object(a.useState)("\u5df2\u770b"),le=Object(u.a)(oe,2),ue=le[0],de=le[1],je=Object(a.useState)(n),be=Object(u.a)(je,2),Oe=be[0],he=be[1],me=Object(a.useState)(c),xe=Object(u.a)(me,2),fe=xe[0],pe=xe[1],ve=Object(a.useState)({}),ge=Object(u.a)(ve,2),ye=ge[0],_e=ge[1],we=Object(a.useState)("end_date"),Ne=Object(u.a)(we,2),ke=Ne[0],Se=Ne[1],Ce=Object(a.useState)(null),Ae=Object(u.a)(Ce,2),Le=Ae[0],Ye=Ae[1];Object(a.useEffect)((function(){_e([]),he(H(n.filter((function(e){return e.status===ue})),"end_date"))}),[e.isLoading,n,ue]),Object(a.useEffect)((function(){null!==ke?(he(H(n.filter((function(e){return e.status===ue})),"\u5728\u770b"===ue&&"end_date"===ke?"start_date":ke)),Se(null)):"\u5728\u770b"===ue&&he(H(n.filter((function(e){return e.status===ue})),"start_date"))}),[ke,n,ue]),Object(a.useEffect)((function(){if(0!==ye.length){for(var e=function(){var e=Object(u.a)(a[t],2),s=e[0],c=e[1];he(n.filter((function(e){return e[s].includes(c)&&e.status===ue})))},t=0,a=Object.entries(ye);t<a.length;t++)e();_e([])}}),[n,ye,ue]);var Ee=function(e){var t=e.target.innerHTML;pe("\u60f3\u770b"===t?i:c),de(t)},Ie=function(e){if(null!==e&&void 0!==e)return e.substring(0,20)+"......"};return e.isLoading?Object(m.jsx)("div",{className:"loading",children:Object(m.jsx)("div",{children:"\u6b63\u5728\u52a0\u8f7d......"})}):e.loadError?Object(m.jsx)(N.a,{variant:"danger",children:"\u756a\u5267\u8bc4\u5206\u52a0\u8f7d\u5931\u8d25\uff01"}):Object(m.jsxs)("div",{className:"main-element",children:[Object(m.jsxs)(y.a,{centered:!0,size:"lg",show:O,onHide:function(){return x(!1)},children:[Object(m.jsx)(y.a.Header,{children:Object(m.jsx)(y.a.Title,{children:"\u7b80\u4ecb"})}),Object(m.jsx)(y.a.Body,{children:Object(m.jsx)(Y,{description:l})}),Object(m.jsx)(y.a.Footer,{children:Object(m.jsx)(_.a,{className:"pink-button",onClick:function(){return x(!1)},children:"\u5173\u95ed"})})]}),Object(m.jsxs)(y.a,{centered:!0,size:"lg",show:C,onHide:function(){return A(!1)},children:[Object(m.jsx)(y.a.Header,{closeButton:!0,children:Object(m.jsx)(y.a.Title,{children:U?"\u6dfb\u52a0\u65b0\u756a\u5267":"\u7f16\u8f91\u756a\u5267"})}),Object(m.jsx)(y.a.Body,{children:Object(m.jsx)(D,{onSubmitOrEdit:function(t,n){t.preventDefault(),U||$?e.onAnimeSubmit(t,null,!0):e.onAnimeSubmit(t,n,!1),A(!1)},oldValue:Le,id:ie})})]}),Object(m.jsxs)(y.a,{centered:!0,size:"lg",show:V,onHide:function(){return F(!1)},children:[Object(m.jsx)(y.a.Header,{closeButton:!0,children:Object(m.jsx)(y.a.Title,{children:"\u6dfb\u52a0\u65b0\u756a\u5267"})}),Object(m.jsx)(y.a.Body,{children:Object(m.jsxs)(w.a,{onSubmit:function(e){e.preventDefault();var t=function(e){var t=e.split("\n")[5].split(" ")[0],n=e.split("\u9996\u64ad: ")[1].split("-")[0],a=e.split("\u8c46\u74e3\u8bc4\u5206")[1].split("\n")[1],s=12;try{s=parseInt(e.split("\u96c6\u6570: ")[1].split("-")[0])}catch(r){console.error(r)}var c=24;try{c=parseInt(e.split("\u5355\u96c6\u7247\u957f: ")[1].split("-")[0])}catch(r){console.error(r)}var i=e.split("\u7684\u5267\u60c5\u7b80\u4ecb \xb7 \xb7 \xb7 \xb7 \xb7 \xb7")[1].split("\n\n")[1].trim();return{name:t,year:n,douban:a,tv_episodes:isNaN(s)?0:s,episode_length:isNaN(c)?12:c,description:i}}(e.target.elements.html.value);Ye({name:t.name,year:t.year,douban:t.douban,tv_episodes:t.tv_episodes,movies:0,episode_length:t.episode_length,status:"\u60f3\u770b",genre:"",description:t.description,story:0,illustration:0,music:0,passion:0,start_date:null,end_date:null,times_watched:0}),Z(!0),F(!1),re(null),A(!0)},children:[Object(m.jsxs)(w.a.Group,{children:[Object(m.jsx)(w.a.Label,{children:"\u8c46\u74e3\u9875\u9762\u6e90"}),Object(m.jsx)(w.a.Control,{id:"html",as:"textarea",rows:"10"})]}),Object(m.jsx)(_.a,{className:"pink-button",type:"submit",children:"\u63d0\u4ea4"})]})})]}),Object(m.jsxs)(y.a,{centered:!0,size:"sm",show:P,onHide:function(){return z(!1)},children:[Object(m.jsx)(y.a.Header,{closeButton:!0,children:Object(m.jsx)(y.a.Title,{children:"\u5220\u9664\u756a\u5267"})}),Object(m.jsx)(y.a.Body,{children:Object(m.jsx)("p",{children:"\u786e\u5b9a\u8981\u5220\u9664\u756a\u5267\u201c".concat(ne.name,"\u201d\u5417")})}),Object(m.jsxs)(y.a.Footer,{children:[Object(m.jsx)(_.a,{variant:"primary",onClick:function(){ae({}),z(!1)},children:"\u53d6\u6d88"}),Object(m.jsx)(_.a,{variant:"danger",onClick:function(){e.deleteAnime(ne.id,"Ratings"),ae({}),z(!1)},children:"\u786e\u5b9a"})]})]}),Object(m.jsxs)("div",{className:"button-group",children:[Object(m.jsxs)("div",{children:[Object(m.jsx)(_.a,{className:"pink-button",onClick:Ee,children:"\u5df2\u770b"}),Object(m.jsx)(_.a,{className:"pink-button",onClick:Ee,children:"\u5728\u770b"}),Object(m.jsx)(_.a,{className:"pink-button",onClick:Ee,children:"\u60f3\u770b"})]}),Object(m.jsxs)("div",{children:[t?Object(m.jsx)(_.a,{className:"pink-button",onClick:function(){Ye(null),re(null),A(!0),W(!0)},children:"\u624b\u52a8\u6dfb\u52a0"}):Object(m.jsx)(m.Fragment,{}),t?Object(m.jsx)(_.a,{className:"pink-button",onClick:function(){Ye(null),re(null),F(!0),W(!0)},children:"\u81ea\u52a8\u6dfb\u52a0"}):Object(m.jsx)(m.Fragment,{}),Object(m.jsx)(_.a,{className:"pink-button",onClick:e.refresh,children:"\u5237\u65b0"})]})]}),Object(m.jsx)("div",{children:Object(m.jsxs)(g.a,{striped:!0,borderless:!0,hover:!0,size:"sm",variant:"light",id:"table",children:[Object(m.jsx)("thead",{children:Object(m.jsx)("tr",{className:"table-headers",children:fe.map((function(e){return"\u540d\u79f0"===e||"\u5206\u7c7b"===e?Object(m.jsx)(L,{header:e,filter:function(t){var n={};for(var a in ye)n[a]=ye[a];n[B(e)]=t.target.value,_e(n)},clearFilter:function(){_e([]),he(H(n.filter((function(e){return e.status===ue})),"end_date"))}},e):"\u5e8f\u53f7"===e?Object(m.jsx)("th",{children:"\u5e8f\u53f7"},e):""!==e?Object(m.jsx)(S,{header:e,sort:function(){return Se(B(e))}},e):Object(m.jsx)("th",{},e)}))})}),Object(m.jsx)("tbody",{children:Oe.map((function(e,n){return Object(m.jsxs)("tr",{children:[Object(m.jsx)("td",{children:n+1}),Object(m.jsx)("td",{className:"anime-name clickable",onClick:function(t){d({name:e.name,douban:e.douban,year:e.year,genre:e.genre,episodes:e.tv_episodes,episode_length:e.episode_length,description:e.description}),x(!0)},children:e.name}),Object(m.jsx)("td",{children:M(e.tv_episodes,e.movies)}),Object(m.jsx)("td",{children:e.genre}),Object(m.jsx)("td",{children:"\u60f3\u770b"===ue?e.year:e.story}),Object(m.jsx)("td",{children:"\u60f3\u770b"===ue?e.douban:e.illustration}),Object(m.jsx)("td",{children:"\u60f3\u770b"===ue?Ie(e.description):e.music}),"\u60f3\u770b"===ue?"":Object(m.jsx)("td",{children:e.passion}),"\u60f3\u770b"===ue?"":Object(m.jsx)("td",{children:e.rating}),"\u60f3\u770b"===ue?"":Object(m.jsx)("td",{children:(a=e.start_date,s=e.end_date,a.isValid()?s.isValid()?"".concat(a.format("MM/DD/YY")," \u81f3 ").concat(s.format("MM/DD/YY")):"".concat(a.format("MM/DD/YY"),"\u81f3\u4eca"):"")}),"\u60f3\u770b"===ue?"":Object(m.jsx)("td",{children:R(Q(e))}),Object(m.jsxs)("td",{children:[" ",t?Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(k.a,{className:"clickable",onClick:function(){re(e.id),Ye({name:e.name,year:e.year,douban:e.douban,tv_episodes:e.tv_episodes,movies:e.movies,episode_length:e.episode_length,status:e.status,genre:e.genre,description:e.description,story:e.story,illustration:e.illustration,music:e.music,passion:e.passion,start_date:e.start_date.format("YYYY-MM-DD"),end_date:e.end_date.format("YYYY-MM-DD"),times_watched:e.times_watched}),W(!1),A(!0)}}),Object(m.jsx)(k.c,{className:"icon clickable",onClick:function(){ae({name:e.name,id:e.id}),z(!0)}})]}):Object(m.jsx)(m.Fragment,{})]})]},e.name);var a,s}))})]})})]})},P=n(288),z=n(107),G=n(181);n(305);function J(e){return Object(m.jsx)("div",{className:"drag-item-container",children:Object(m.jsx)(G.b,{draggableId:e.index.toString(),index:e.index,children:function(t,n){return Object(m.jsx)("div",Object(z.a)(Object(z.a)(Object(z.a)({ref:t.innerRef},t.draggableProps),t.dragHandleProps),{},{style:(a=n.isDragging,s=t.draggableProps.style,Object(z.a)({background:a?"grey":"transparent"},s)),className:"drag-item",children:Object(m.jsxs)("div",{className:"ranking-entry".concat(e.index<3?"-red":""),children:[Object(m.jsx)("div",{className:"ranking-entry-num",children:Object(m.jsx)("b",{children:e.index+1})}),Object(m.jsx)("div",{className:"ranking-entry-name",children:e.anime})]})}));var a,s}},e.index)})}function U(e){return Object(m.jsx)("div",{id:"rankings",children:Object(m.jsx)(G.a,{onDragEnd:e.onDragEnd,children:Object(m.jsx)(G.c,{droppableId:"droppable",children:function(t,n){return Object(m.jsxs)("div",Object(z.a)(Object(z.a)({},t.droppableProps),{},{ref:t.innerRef,className:"drag-list",children:[e.rankings.map((function(e,t){return Object(m.jsx)(J,{anime:e,index:t})})),t.placeholder]}))}})})})}var W=n(182);n(309),n(310);function K(e){var t=[V()().subtract(1,"days"),V()(),V()().add(1,"days")];return V.a.locale("zh-cn"),Object(m.jsx)("div",{id:"daily-new-animes",children:t.map((function(t){return Object(m.jsxs)(W.a,{children:[Object(m.jsx)(W.a.Item,{variant:t.isSame(V()(),"day")?"primary":"dark",children:t.format("dddd[\uff0c]YYYY[\u5e74]MMMDo ")}),e.displayList.filter((function(e){var n=V()(e.start_date);return t.isAfter(n)&&t.diff(n,"days")%7===0})).map((function(e){return Object(m.jsx)(W.a.Item,{children:e.name},e.name)}))]})}))})}n(311);function X(e){var t=void 0===e.oldValue||null===e.oldValue?{}:e.oldValue;return Object(m.jsxs)(w.a,{id:"new-anime-modal",onSubmit:function(t){e.onSubmitOrEdit(t,e.id)},children:[Object(m.jsxs)(w.a.Group,{controlId:"name",children:[Object(m.jsx)(w.a.Label,{children:"\u540d\u79f0"}),Object(m.jsx)(w.a.Control,{defaultValue:t.name,type:"input"})]}),Object(m.jsxs)(w.a.Row,{className:"input-row",children:[Object(m.jsxs)(E.a,{children:[Object(m.jsx)(w.a.Label,{children:"\u5b63\u5ea6"}),Object(m.jsx)(w.a.Control,{defaultValue:t.season,id:"season",type:"input"})]}),Object(m.jsxs)(E.a,{children:[Object(m.jsx)(w.a.Label,{children:"\u5f00\u59cb\u653e\u9001\u65e5\u671f"}),Object(m.jsx)(w.a.Control,{defaultValue:t.start_date,id:"start_date",type:"input"})]}),Object(m.jsxs)(E.a,{children:[Object(m.jsx)(w.a.Label,{children:"\u66f4\u65b0\u65e5"}),Object(m.jsx)(w.a.Control,{defaultValue:t.next_episode_day,id:"next_episode_day",type:"input"})]})]}),Object(m.jsxs)(w.a.Group,{children:[Object(m.jsxs)(w.a.Row,{className:"input-row",children:[Object(m.jsxs)(E.a,{children:[Object(m.jsx)(w.a.Label,{children:"\u72b6\u6001"}),Object(m.jsx)(w.a.Control,{defaultValue:t.status,id:"status",type:"input"})]}),Object(m.jsxs)(E.a,{children:[Object(m.jsx)(w.a.Label,{children:"\u5206\u7c7b"}),Object(m.jsx)(w.a.Control,{defaultValue:t.genre,id:"genre",type:"input"})]}),Object(m.jsxs)(E.a,{children:[Object(m.jsx)(w.a.Label,{children:"\u9884\u8ba1\u96c6\u6570"}),Object(m.jsx)(w.a.Control,{defaultValue:t.tv_episodes,id:"tv_episodes",type:"input"})]})]}),Object(m.jsxs)(w.a.Group,{children:[Object(m.jsx)(w.a.Label,{children:"\u7b80\u4ecb"}),Object(m.jsx)(w.a.Control,{defaultValue:t.description,id:"description",as:"textarea",rows:"3"})]})]}),Object(m.jsxs)("div",{children:[Object(m.jsx)(_.a,{className:"pink-button",type:"submit",children:"\u63d0\u4ea4"}),e.submitNewAnime?Object(m.jsx)(m.Fragment,{}):Object(m.jsx)(_.a,{onClick:function(){var t=document.getElementById("new-anime-modal").elements;e.handleRateNewAnime({name:t.name.value,tv_episodes:Number(t.tv_episodes.value),genre:t.genre.value,description:t.description.value,start_date:t.start_date.value,status:t.status.value})},children:"\u5df2\u8ffd\u5b8c"})]})]})}var $=function(e){var t=h().authenticated,n=s.a.useContext(v).newAnimes,c=Object(a.useState)([]),i=Object(u.a)(c,2),r=i[0],o=i[1],l=Object(a.useState)(!1),d=Object(u.a)(l,2),j=d[0],b=d[1],O=Object(a.useState)(!1),x=Object(u.a)(O,2),f=x[0],p=x[1],w=Object(a.useState)(!1),C=Object(u.a)(w,2),A=C[0],L=C[1],Y=Object(a.useState)(!1),E=Object(u.a)(Y,2),I=E[0],R=E[1],Q=Object(a.useState)(!1),F=Object(u.a)(Q,2),q=F[0],z=F[1],G=Object(a.useState)({}),J=Object(u.a)(G,2),W=J[0],$=J[1],Z=Object(a.useState)({}),ee=Object(u.a)(Z,2),te=ee[0],ne=ee[1],ae=Object(a.useState)(!1),se=Object(u.a)(ae,2),ce=se[0],ie=se[1],re=Object(a.useState)({}),oe=Object(u.a)(re,2),le=oe[0],ue=oe[1],de=Object(a.useState)(),je=Object(u.a)(de,2),be=je[0],Oe=je[1],he=Object(a.useState)(n),me=Object(u.a)(he,2),xe=me[0],fe=me[1],pe=Object(a.useState)(null),ve=Object(u.a)(pe,2),ge=ve[0],ye=ve[1],_e=Object(a.useState)(null),we=Object(u.a)(_e,2),Ne=we[0],ke=we[1],Se=Object(a.useState)(null),Ce=Object(u.a)(Se,2),Ae=Ce[0],Le=Ce[1],Ye=Object(a.useState)(null),Ee=Object(u.a)(Ye,2),Ie=Ee[0],Ve=Ee[1];Object(a.useEffect)((function(){Le("ranking")}),[]);var De=function(e){ye(e.target.innerHTML)},Me=function(e,t){e.sort((function(e,n){return t[e.name]>t[n.name]?1:t[e.name]<t[n.name]?-1:0}))},Re=function(e){for(var t=new Array(Object.entries(e).length),n=0,a=Object.entries(e);n<a.length;n++){var s=Object(u.a)(a[n],2),c=s[0];t[s[1]-1]=c}return t};return Object(a.useEffect)((function(){if(null!==Ae){var e=n.filter((function(e){return e.season.includes(ge)}));"ranking"===Ae?(Me(e,W),fe(e)):fe(H(e,Ae)),Le(null)}}),[Ae,n,ge,W]),Object(a.useEffect)((function(){var e=function(){var e=new Date,t=e.getFullYear(),n=3*Math.floor(e.getMonth()/3)+1,a=t+"\u5e74"+(n-3)+"\u6708",s=t+"\u5e74"+(n+3)+"\u6708";return 1===n&&(a=t-1+"\u5e7410\u6708"),10===n&&(s=t+1+"\u5e741\u6708"),[a,t+"\u5e74"+n+"\u6708",s]}();o(e),ye(e[1])}),[]),Object(a.useEffect)((function(){var e=n.filter((function(e){return e.season.includes(ge)})),t=T(e,ge);Me(e,t),fe(e),$(t),ne(t)}),[e.isLoading,n,ge]),e.isLoading?Object(m.jsx)("div",{className:"loading",children:Object(m.jsx)("div",{children:"\u6b63\u5728\u52a0\u8f7d......"})}):e.loadError?Object(m.jsx)(N.a,{variant:"danger",children:"\u8ffd\u756a\u5217\u8868\u52a0\u8f7d\u5931\u8d25\uff01"}):Object(m.jsxs)("div",{className:"main-element",children:[Object(m.jsxs)(y.a,{centered:!0,size:"lg",show:j,onHide:function(){return b(!1)},children:[Object(m.jsx)(y.a.Header,{closeButton:!0,children:Object(m.jsx)(y.a.Title,{children:ce?"\u6dfb\u52a0\u65b0\u8ffd\u756a":"\u7f16\u8f91\u8ffd\u756a"})}),Object(m.jsx)(y.a.Body,{children:Object(m.jsx)(X,{submitNewAnime:ce,onSubmitOrEdit:function(t,n){if(t.preventDefault(),ce){var a=Math.max.apply(Math,Object(P.a)(Object.values(T(xe,ge))))+1;e.onNewAnimeSubmit(t,null,!0,a)}else e.onNewAnimeSubmit(t,n,!1);b(!1)},oldValue:Ne,id:be,handleRateNewAnime:function(e){e.status="\u5df2\u770b",Ve(e),b(!1),p(!0)}})})]}),Object(m.jsxs)(y.a,{centered:!0,size:"lg",show:f,onHide:function(){return p(!1)},children:[Object(m.jsx)(y.a.Header,{closeButton:!0,children:Object(m.jsx)(y.a.Title,{children:"\u8bc4\u4ef7\u756a\u5267"})}),Object(m.jsx)(y.a.Body,{children:Object(m.jsx)(D,{onSubmitOrEdit:function(t,n){t.preventDefault(),e.onAnimeSubmit(t,n,!0),p(!1)},oldValue:Ie,id:be})})]}),Object(m.jsxs)(y.a,{centered:!0,size:"sm",show:A,onHide:function(){return L(!1)},children:[Object(m.jsx)(y.a.Header,{closeButton:!0,children:Object(m.jsx)(y.a.Title,{children:"\u5220\u9664\u756a\u5267"})}),Object(m.jsx)(y.a.Body,{children:Object(m.jsx)("p",{children:"\u786e\u5b9a\u8981\u5220\u9664\u756a\u5267\u201c".concat(le.name,"\u201d\u5417")})}),Object(m.jsxs)(y.a.Footer,{children:[Object(m.jsx)(_.a,{variant:"primary",onClick:function(){ue({}),L(!1)},children:"\u53d6\u6d88"}),Object(m.jsx)(_.a,{variant:"danger",onClick:function(){e.deleteNewAnime(le.id,"NewAnimes"),ue({}),L(!1)},children:"\u786e\u5b9a"})]})]}),Object(m.jsxs)(y.a,{centered:!0,size:"lg",show:I,onHide:function(){return R(!1)},children:[Object(m.jsx)(y.a.Header,{closeButton:!0,children:Object(m.jsx)(y.a.Title,{children:"\u756a\u5267\u6392\u540d"})}),Object(m.jsx)(y.a.Body,{children:Object(m.jsx)(U,{rankings:Re(te),onDragEnd:function(e){if(e.destination){var t=function(e,t,n){var a=Array.from(e),s=a.splice(t,1),c=Object(u.a)(s,1)[0];return a.splice(n,0,c),a}(Re(te),e.source.index,e.destination.index),n={};t.forEach((function(e,t){return n[e]=t+1})),ne(n)}}})}),Object(m.jsx)(y.a.Footer,{children:Object(m.jsx)(_.a,{variant:"primary",onClick:function(){var t=[],n={},a=V()().format("YYYY-MM-DD");xe.forEach((function(e){t.push(e.id);var s=Object.assign({},e.seasons_ranking);s[ge][a]=te[e.name],n[e.id]=s})),e.updateNewAnimesRankings(t,n,ge),R(!1)},children:"\u63d0\u4ea4"})})]}),Object(m.jsxs)(y.a,{centered:!0,size:"lg",show:q,onHide:function(){return z(!1)},children:[Object(m.jsx)(y.a.Header,{closeButton:!0,children:Object(m.jsx)(y.a.Title,{children:"\u8fd1\u671f\u66f4\u65b0"})}),Object(m.jsx)(y.a.Body,{children:Object(m.jsx)(K,{displayList:xe})})]}),Object(m.jsxs)("div",{className:"button-group",children:[Object(m.jsx)("div",{children:r.map((function(e){return Object(m.jsx)(_.a,{className:"pink-button",onClick:De,children:e},e)}))}),Object(m.jsxs)("div",{children:[t?Object(m.jsx)(_.a,{className:"pink-button",onClick:function(){ie(!0),ke(null),Oe(null),b(!0)},children:"\u6dfb\u52a0\u8ffd\u756a"}):Object(m.jsx)(m.Fragment,{}),t?Object(m.jsx)(_.a,{className:"pink-button",onClick:function(){return R(!0)},children:"\u6392\u540d"}):Object(m.jsx)(m.Fragment,{}),Object(m.jsx)(_.a,{className:"pink-button",onClick:function(){return z(!0)},children:"\u8fd1\u671f\u66f4\u65b0"}),Object(m.jsx)(_.a,{className:"pink-button",onClick:e.refresh,children:"\u5237\u65b0"})]})]}),Object(m.jsx)("div",{children:Object(m.jsxs)(g.a,{striped:!0,borderless:!0,hover:!0,size:"sm",variant:"light",id:"table",children:[Object(m.jsx)("thead",{children:Object(m.jsx)("tr",{className:"table-headers",children:["\u6392\u540d","\u540d\u79f0","\u5206\u7c7b","\u5b63\u5ea6","\u5f00\u59cb\u653e\u9001\u65e5\u671f","\u66f4\u65b0\u65e5","\u9884\u8ba1\u96c6\u6570","\u72b6\u6001",""].map((function(e){return"\u66f4\u65b0\u65e5"===e||"\u6392\u540d"===e||"\u5f00\u59cb\u653e\u9001\u65e5\u671f"===e?Object(m.jsx)(S,{header:e,sort:function(){return Le(B(e))}},e):Object(m.jsx)("th",{children:e},e)}))})}),Object(m.jsx)("tbody",{children:xe.map((function(e){return Object(m.jsxs)("tr",{children:[Object(m.jsx)("td",{children:W[e.name]}),Object(m.jsx)("td",{className:"anime-name",children:e.name}),Object(m.jsx)("td",{children:e.genre}),Object(m.jsx)("td",{children:e.season}),Object(m.jsx)("td",{children:e.start_date}),Object(m.jsx)("td",{children:e.next_episode_day}),Object(m.jsx)("td",{children:M(e.tv_episodes,0)}),Object(m.jsx)("td",{children:e.status}),Object(m.jsxs)("td",{children:[" ",t?Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(k.a,{className:"clickable",onClick:function(){Oe(e.id),ke({name:e.name,tv_episodes:e.tv_episodes,genre:e.genre,description:e.description,start_date:e.start_date,next_episode_day:e.next_episode_day,season:e.season,status:e.status}),ie(!1),b(!0)}}),Object(m.jsx)(k.c,{className:"icon clickable",onClick:function(){ue({name:e.name,id:e.id}),L(!0)}})]}):Object(m.jsx)(m.Fragment,{})]})]},e.name)}))})]})})]})},Z=n(285),ee=(n(312),Object(a.createContext)(null));function te(){return Object(a.useContext)(ee)}function ne(e){var t=h().authenticated,n=te(),a=n.setQuoteToEdit,s=n.setShowQuoteModal,c=n.setIsNewQuote,i=n.setActiveQuoteId,r=n.setShowDeleteConfirmation;return Object(m.jsxs)("blockquote",{children:[Object(m.jsx)("div",{className:"quote-content",children:e.quote.content}),Object(m.jsx)("div",{className:"quote-translation",children:e.quote.translation}),Object(m.jsxs)("cite",{children:[e.quote.person+"\u300a"+e.quote.bangumi+"\u300b",t?Object(m.jsx)(k.a,{className:"icon clickable",onClick:function(){c(!1),a(e.quote),s(!0)}}):Object(m.jsx)(m.Fragment,{}),t?Object(m.jsx)(k.c,{className:"icon clickable",onClick:function(){i(e.quote.id),r(!0)}}):Object(m.jsx)(m.Fragment,{})]})]})}function ae(e){var t=h().authenticated,n=te(),a=n.setIsNewQuote,s=n.setQuoteToEdit,c=n.addNewQuote;return Object(m.jsxs)("div",{className:"summary",children:[Object(m.jsxs)("div",{className:"summary-title",children:[Object(m.jsxs)("div",{className:"summary-info",children:[Object(m.jsxs)("div",{className:"year-month",children:[Object(m.jsx)("div",{className:"month",children:V()(e.month).format("MM")}),Object(m.jsx)("div",{className:"year",children:V()(e.month).format("YYYY")}),Object(m.jsx)("div",{className:"yue",children:"\u6708"})]}),Object(m.jsxs)("div",{className:"summary-info-pieces",children:[Object(m.jsx)("div",{className:"summary-info-piece",children:"\u756a\u5267\u603b\u6570\uff1a"+e.summary.bangumi_num}),Object(m.jsx)("div",{className:"summary-info-piece",children:"\u603b\u96c6\u6570\uff1a"+e.summary.tv_episode_num}),Object(m.jsx)("div",{className:"summary-info-piece",children:"\u603b\u65f6\u957f\uff1a"+R(e.summary.total_time)}),Object(m.jsx)("div",{className:"summary-info-piece",children:"\u6bcf\u65e5\u65f6\u957f\uff1a"+R(e.summary.total_time/V()(e.month).daysInMonth())})]})]}),Object(m.jsx)("div",{className:"summary-quotes",children:0!==e.summary.quotes.length?Object(m.jsxs)(m.Fragment,{children:[e.summary.quotes.map((function(t,n){return Object(m.jsx)(ne,{quote:t,setActiveQuoteId:e.setActiveQuoteId},n)})),t?Object(m.jsx)(Z.a,{className:"clickable add-more-quote-button",onClick:function(){c(e.month),a(!0),s({})}}):Object(m.jsx)(m.Fragment,{})]}):t?Object(m.jsx)(_.a,{className:"pink-button add-quote-button",onClick:function(){c(e.month),s({})},children:"\u6dfb\u52a0\u8bed\u5f55"}):Object(m.jsx)("div",{className:"add-quote-button",children:"\u6682\u65e0\u8bed\u5f55"})})]}),Object(m.jsx)("div",{className:"summary-names",children:e.summary.bangumis.map((function(e,t){return Object(m.jsx)("div",{className:"bangumi-name",children:"\u2022 "+e},t)}))})]})}var se=function(e){var t=Object(a.useContext)(v).monthlySummaries,n=Object(a.useState)(!0),s=Object(u.a)(n,2),c=s[0],i=s[1],r=Object(a.useState)(!1),o=Object(u.a)(r,2),l=o[0],d=o[1],j=Object(a.useState)(!1),b=Object(u.a)(j,2),O=b[0],h=b[1],x=Object(a.useState)(),f=Object(u.a)(x,2),p=f[0],g=f[1],N=Object(a.useState)({}),k=Object(u.a)(N,2),S=k[0],C=k[1],A=Object(a.useState)(""),L=Object(u.a)(A,2),Y=L[0],I=L[1],V=function(e){d(!0),I(e)};return Object(m.jsxs)("div",{className:"summaries",children:[Object(m.jsxs)(y.a,{centered:!0,size:"lg",show:l,onHide:function(){return d(!1)},children:[Object(m.jsx)(y.a.Header,{closeButton:!0,children:Object(m.jsx)(y.a.Title,{children:c?"\u6dfb\u52a0\u65b0\u8bed\u5f55":"\u7f16\u8f91\u8bed\u5f55"})}),Object(m.jsx)(y.a.Body,{children:Object(m.jsxs)(w.a,{onSubmit:function(t){c?(t.preventDefault(),e.onQuoteSubmit(t,Y,S.id,!0)):(t.preventDefault(),e.onQuoteSubmit(t,S.month,S.id,!1)),d(!1)},children:[Object(m.jsxs)(w.a.Group,{controlId:"content",children:[Object(m.jsx)(w.a.Label,{children:"\u8bed\u5f55\u539f\u6587"}),Object(m.jsx)(w.a.Control,{defaultValue:S.content,type:"input",as:"textarea",rows:"3"})]}),Object(m.jsxs)(w.a.Group,{controlId:"translation",children:[Object(m.jsx)(w.a.Label,{children:"\u4e2d\u6587\u7ffb\u8bd1"}),Object(m.jsx)(w.a.Control,{defaultValue:S.translation,type:"input",as:"textarea",rows:"3"})]}),Object(m.jsxs)(w.a.Row,{className:"input-row",children:[Object(m.jsxs)(E.a,{children:[Object(m.jsx)(w.a.Label,{children:"\u4eba\u7269"}),Object(m.jsx)(w.a.Control,{defaultValue:S.person,id:"person",type:"input"})]}),Object(m.jsxs)(E.a,{children:[Object(m.jsx)(w.a.Label,{children:"\u4f5c\u54c1"}),Object(m.jsx)(w.a.Control,{defaultValue:S.bangumi,id:"bangumi",type:"input"})]})]}),Object(m.jsx)(_.a,{className:"pink-button",type:"submit",children:"\u63d0\u4ea4"})]})})]}),Object(m.jsxs)(y.a,{centered:!0,size:"sm",show:O,onHide:function(){return h(!1)},children:[Object(m.jsx)(y.a.Header,{closeButton:!0,children:Object(m.jsx)(y.a.Title,{children:"\u5220\u9664\u8bed\u5f55"})}),Object(m.jsx)(y.a.Body,{children:Object(m.jsx)("p",{children:"\u786e\u5b9a\u8981\u5220\u9664\u6b64\u8bed\u5f55\u5417"})}),Object(m.jsxs)(y.a.Footer,{children:[Object(m.jsx)(_.a,{variant:"primary",onClick:function(){g(null),h(!1)},children:"\u53d6\u6d88"}),Object(m.jsx)(_.a,{variant:"danger",onClick:function(){e.deleteQuote(p),g(null),h(!1)},children:"\u786e\u5b9a"})]})]}),function(e){for(var t=[],n=0,a=Object.entries(e);n<a.length;n++){var s=Object(u.a)(a[n],2),c=s[0],i=s[1];t.push([c,i])}return t.sort((function(e,t){return-1*e[0].localeCompare(t[0])})),t}(t).map((function(e,t){return Object(m.jsx)(ee.Provider,{value:{setIsNewQuote:i,setShowQuoteModal:d,addNewQuote:V,setQuoteToEdit:C,setActiveQuoteId:g,setShowDeleteConfirmation:h},children:Object(m.jsx)(ae,{month:e[0],summary:e[1]})},t)}))]})},ce=n(286),ie=n.n(ce),re=n(287),oe=n.n(re);n(313);function le(e){var t=Object(a.useContext)(v).newAnimes,n=Object(a.useState)([]),s=Object(u.a)(n,2),c=s[0],i=s[1],r=function(e){for(var t=[],n=0,a=Object.entries(e);n<a.length;n++){var s=Object(u.a)(a[n],2),c=s[0],i=s[1];t.push([new Date(c).valueOf(),i])}return t};return Object(a.useEffect)((function(){var e={};t.forEach((function(t){for(var n=t.seasons_ranking,a=0,s=Object.entries(n);a<s.length;a++){var c=Object(u.a)(s[a],2),i=c[0],o=c[1];void 0===e[i]&&(e[i]={chart:{height:600,borderRadius:10},title:{text:i},xAxis:{type:"datetime",labels:{format:"{value:%Y-%b-%e}"},title:{text:"\u65e5\u671f"}},yAxis:{title:{text:"\u6392\u540d"},tickInterval:1,min:1,reversed:!0},series:[]}),e[i].series.push({name:t.name,data:r(o)})}}));var n=Array.from(Object.values(e));n.sort((function(e,t){return-function(e,t){var n=parseInt(e.split("\u5e74")[0]),a=parseInt(e.split("\u5e74")[1].replace("\u65e5","")),s=parseInt(t.split("\u5e74")[0]),c=parseInt(t.split("\u5e74")[1].replace("\u65e5",""));return n===s?a-c:n-s}(e.title.text,t.title.text)})),i(n)}),[t]),Object(m.jsx)("div",{className:"summaries seasonal-summaries",children:c.map((function(e,t){return Object(m.jsx)("div",{className:"summary-chart",children:Object(m.jsx)(oe.a,{highcharts:ie.a,options:e})},t)}))})}n(314);function ue(){var e=h(),t=e.username,n=e.password,a=e.setAuthenticating,s=e.setUsername,c=e.setPassword,i=e.handleLogin;return Object(m.jsx)("div",{className:"Login",children:Object(m.jsxs)(w.a,{onSubmit:i,children:[Object(m.jsxs)(w.a.Group,{size:"lg",controlId:"username",children:[Object(m.jsx)(w.a.Label,{children:"\u7528\u6237\u540d"}),Object(m.jsx)(w.a.Control,{autoFocus:!0,type:"username",value:t,onChange:function(e){return s(e.target.value)}})]}),Object(m.jsxs)(w.a.Group,{size:"lg",controlId:"password",children:[Object(m.jsx)(w.a.Label,{children:"\u5bc6\u7801"}),Object(m.jsx)(w.a.Control,{type:"password",value:n,onChange:function(e){return c(e.target.value)}})]}),Object(m.jsxs)("div",{className:"button-group",children:[Object(m.jsx)(_.a,{className:"pink-button",size:"lg",type:"submit",disabled:!(t.length>0&&n.length>0),children:"\u767b\u9646"}),Object(m.jsx)(_.a,{className:"pink-button",size:"lg",type:"submit",onClick:function(){return a(!1)},children:"\u53d6\u6d88"})]})]})})}n(315);var de=n(23),je=n.n(de);je.a.initialize(d.APPLICATION_ID,d.JAVASCRIPT_KEY),je.a.serverURL=d.SERVER_URL;var be=function(){var e=Object(a.useState)(!1),t=Object(u.a)(e,2),n=t[0],s=t[1],c=Object(a.useState)(!1),i=Object(u.a)(c,2),r=i[0],d=i[1],j=Object(a.useState)(""),b=Object(u.a)(j,2),h=b[0],x=b[1],p=Object(a.useState)(""),g=Object(u.a)(p,2),y=g[0],_=g[1],w=Object(a.useState)(function(){var e=sessionStorage.getItem("user");return e?JSON.parse(e):null}()),N=Object(u.a)(w,2),k=N[0],S=N[1],C=Object(a.useState)(sessionStorage.getItem("token")||null),A=Object(u.a)(C,2),L=A[0],Y=A[1],E=Object(a.useState)(!0),I=Object(u.a)(E,2),D=I[0],M=I[1],R=Object(a.useState)(!1),Q=Object(u.a)(R,2),B=Q[0],F=Q[1],T=Object(a.useState)("AnimeList"),P=Object(u.a)(T,2),z=P[0],G=P[1],J=Object(a.useState)([]),U=Object(u.a)(J,2),W=U[0],K=U[1],X=Object(a.useState)([]),Z=Object(u.a)(X,2),ee=Z[0],te=Z[1],ne=Object(a.useState)({}),ae=Object(u.a)(ne,2),ce=ae[0],ie=ae[1],re=Object(a.useState)([]),oe=Object(u.a)(re,2),de=oe[0],be=oe[1],Oe=function(){var e=Object(l.a)(o.a.mark((function e(){var t,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:M(!0),t=je.a.Object.extend("Ratings"),(n=new je.a.Query(t)).limit(1e3),n.find().then((function(e){if(console.log("calling server for ratings"),"undefined"!==typeof document){var t=e.map((function(e){return{id:e.id,name:e.get("name"),year:e.get("year"),douban:e.get("douban"),tv_episodes:e.get("tv_episodes"),movies:e.get("movies"),episode_length:e.get("episode_length"),status:e.get("status"),genre:e.get("genre"),description:e.get("description"),story:e.get("story"),illustration:e.get("illustration"),music:e.get("music"),passion:e.get("passion"),rating:Number((e.get("story")+e.get("illustration")+e.get("music")+e.get("passion")).toFixed(1)),start_date:V()(e.get("start_date"),"YYYY-MM-DD"),end_date:V()(e.get("end_date"),"YYYY-MM-DD"),times_watched:e.get("times_watched")}}));K(H(t,"start_date")),M(!1)}}),(function(e){M(!1),F(!0),console.error("Error while fetching ratings",e)}));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),he=function(){var e=Object(l.a)(o.a.mark((function e(){var t,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=je.a.Object.extend("Quotes"),(n=new je.a.Query(t)).limit(1e3),n.find().then((function(e){if(console.log("calling server for quotes"),"undefined"!==typeof document){var t=e.map((function(e){return{id:e.id,month:e.get("month"),content:e.get("content"),translation:e.get("translation"),person:e.get("person"),bangumi:e.get("bangumi")}}));be(t)}}),(function(e){F(!0),console.error("Error while fetching quotes",e)}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),me=function(){var e=Object(l.a)(o.a.mark((function e(){var t,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:M(!0),t=je.a.Object.extend("NewAnimes"),(n=new je.a.Query(t)).limit(1e3),n.find().then((function(e){if(console.log("calling server for new animes"),"undefined"!==typeof document){var t=e.map((function(e){return{id:e.id,name:e.get("name"),genre:e.get("genre"),seasons_ranking:e.get("seasons_ranking"),start_date:e.get("start_date"),next_episode_day:e.get("next_episode_day"),tv_episodes:e.get("tv_episodes"),description:e.get("description"),season:e.get("season"),status:e.get("status")}}));te(t),M(!1)}}),(function(e){M(!1),F(!0),console.error("Error while fetching new animes",e)}));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),xe=function(){var e=Object(l.a)(o.a.mark((function e(t,n){var a,s,c,i,r,l,d,j;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=je.a.Object.extend(n),(s=new je.a.Query(a)).equalTo("name",t.name),e.next=5,s.find();case 5:if(e.sent.length>0)alert("\u756a\u5267\u300a"+t.name+"\u300b\u5df2\u5b58\u5728\uff01\u8bf7\u52ff\u91cd\u590d\u6dfb\u52a0\u756a\u5267\uff01");else{for(c=new a,i=0,r=Object.entries(t);i<r.length;i++)l=Object(u.a)(r[i],2),d=l[0],j=l[1],c.set(d,j);c.save().then((function(e){alert("\u5df2\u63d0\u4ea4\u756a\u5267\u4fe1\u606f\uff01"),"Ratings"===n?Oe():"NewAnimes"===n&&me()}),(function(e){alert("\u66f4\u65b0\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\u3002")}))}case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),fe=function(){var e=Object(l.a)(o.a.mark((function e(t){var n,a,s,c,i,r,l;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=je.a.Object.extend("Quotes"),a=new n,s=0,c=Object.entries(t);s<c.length;s++)i=Object(u.a)(c[s],2),r=i[0],l=i[1],a.set(r,l);a.save().then((function(e){alert("\u5df2\u6dfb\u52a0\u8bed\u5f55\uff01"),he()}),(function(e){alert("\u6dfb\u52a0\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\u3002")}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),pe=function(){var e=Object(l.a)(o.a.mark((function e(t,n,a){var s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=je.a.Object.extend(a),new je.a.Query(s).get(t).then((function(e){for(var t=0,s=Object.entries(n);t<s.length;t++){var c=Object(u.a)(s[t],2),i=c[0],r=c[1];e.set(i,r)}e.save().then((function(e){alert("\u5df2\u66f4\u65b0\u756a\u5267\u4fe1\u606f\uff01"),"Ratings"===a?Oe():"NewAnimes"===a&&me()}),(function(e){alert("\u66f4\u65b0\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\u3002")}))}));case 3:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),ve=function(){var e=Object(l.a)(o.a.mark((function e(t,n){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=je.a.Object.extend("Quotes"),new je.a.Query(a).get(t).then((function(e){for(var t=0,a=Object.entries(n);t<a.length;t++){var s=Object(u.a)(a[t],2),c=s[0],i=s[1];e.set(c,i)}e.save().then((function(e){alert("\u5df2\u66f4\u65b0\u8bed\u5f55\uff01"),he()}),(function(e){alert("\u66f4\u65b0\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\u3002")}))}));case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),ge=function(){var e=Object(l.a)(o.a.mark((function e(t,n,a){var s,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=je.a.Object.extend("NewAnimes"),(c=new je.a.Query(s)).containedIn("objectId",t),c.find().then((function(e){e.forEach((function(e){e.set("seasons_ranking",n[e.id])})),je.a.Object.saveAll(e).then((function(e){alert("\u5df2\u66f4\u65b0\u6392\u540d\uff01"),me()}),(function(e){alert("\u66f4\u65b0\u6392\u540d\u5931\u8d25\u3002")}))}),(function(e){alert("\u66f4\u65b0\u6392\u540d\u5931\u8d25\u3002")}));case 4:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),ye=function(){var e=Object(l.a)(o.a.mark((function e(t,n){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=je.a.Object.extend(n),new je.a.Query(a).get(t).then((function(e){e.destroy().then((function(e){alert("\u5df2\u5220\u9664\u756a\u5267\uff01"),"Ratings"===n?Oe():"NewAnimes"===n&&me()}),(function(e){alert("\u5220\u9664\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\u3002")}))}));case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),_e=function(){var e=Object(l.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=je.a.Object.extend("Quotes"),new je.a.Query(n).get(t).then((function(e){e.destroy().then((function(e){alert("\u5df2\u5220\u9664\u8bed\u5f55\uff01"),he()}),(function(e){alert("\u5220\u9664\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\u3002")}))}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(a.useEffect)((function(){Oe(),me(),he()}),[]),Object(a.useEffect)((function(){var e={};W.filter((function(e){return"\u5df2\u770b"===e.status})).forEach((function(t){var n=V()(t.end_date).format("YYYY-MM");n in e||(e[n]={bangumi_num:0,tv_episode_num:0,movie_num:0,total_time:0,daily_time:0,bangumis:[],quotes:[]}),e[n].bangumi_num+=1,e[n].bangumis.push(t.name),e[n].tv_episode_num+=t.tv_episodes,e[n].movie_num+=t.movies,e[n].total_time+=t.tv_episodes*t.episode_length+90*t.movies})),de.forEach((function(t){var n=V()(t.month).format("YYYY-MM");n in e&&e[n].quotes.push(t)})),ie(e)}),[W,de]),Object(a.useEffect)((function(){null!=k&&null!=L&&s(!0)}),[k,L]);var we=function(e,t,n){e.preventDefault();var a=e.target.elements,s={name:a.name.value,year:a.year.value,douban:Number(a.douban.value),tv_episodes:Number(a.tv_episodes.value),movies:Number(a.movies.value),episode_length:Number(a.episode_length.value),status:a.status.value,genre:a.genre.value,description:a.description.value,story:Number(a.story.value),illustration:Number(a.illustration.value),music:Number(a.music.value),passion:Number(a.passion.value),start_date:a.start_date.value,end_date:a.end_date.value,times_watched:Number(a.times_watched.value)};n?xe(s,"Ratings"):pe(t,s,"Ratings")},Ne=function(e,t,n,a){e.preventDefault();var s=e.target.elements,c={name:s.name.value,tv_episodes:Number(s.tv_episodes.value),genre:s.genre.value,description:s.description.value,start_date:s.start_date.value,next_episode_day:s.next_episode_day.value,season:s.season.value,status:s.status.value};if(n){var i=s.season.value.split("\uff0c"),r={};r[i=i[i.length-1]]={},r[i][V()().format("YYYY-MM-DD")]=a,c.seasons_ranking=r,xe(c,"NewAnimes")}else pe(t,c,"NewAnimes")},ke=function(e,t,n,a){e.preventDefault();var s=e.target.elements,c={month:t,content:s.content.value,translation:s.translation.value,person:s.person.value,bangumi:s.bangumi.value};a?fe(c):ve(n,c)};return Object(m.jsx)("div",{children:Object(m.jsx)("div",{className:"App",children:Object(m.jsxs)(O.Provider,{value:{username:h,password:y,authenticated:n,setAuthenticating:d,handleLogin:function(e){e.preventDefault(),je.a.User.logIn(h,y).then((function(e){!function(e,t){sessionStorage.setItem("token",t),sessionStorage.setItem("user",JSON.stringify(e))}(e,e.getSessionToken()),alert("\u6b22\u8fce\uff0c"+e.getUsername()),d(!1),s(!0)})).catch((function(e){alert(e.message)}))},handleSignOut:function(){S(null),Y(null),sessionStorage.removeItem("token"),sessionStorage.removeItem("user"),s(!1)},setUsername:x,setPassword:_},children:[Object(m.jsx)(f,{switchPage:G}),r?Object(m.jsx)(ue,{}):Object(m.jsx)(v.Provider,{value:{ratings:W,monthlySummaries:ce,newAnimes:ee},children:function(e){switch(e){default:return Object(m.jsx)(q,{isLoading:D,loadError:B,refresh:Oe,onAnimeSubmit:we,deleteAnime:ye});case"NewAnimeList":return Object(m.jsx)($,{isLoading:D,loadError:B,refresh:me,onAnimeSubmit:we,onNewAnimeSubmit:Ne,updateEntry:pe,deleteNewAnime:ye,updateNewAnimesRankings:ge});case"MonthlySummary":return Object(m.jsx)(se,{onQuoteSubmit:ke,deleteQuote:_e});case"SeasonalSummary":return Object(m.jsx)(le,{})}}(z)})]})})})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(Object(m.jsx)(s.a.StrictMode,{children:Object(m.jsx)(be,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[630,1,2]]]);
//# sourceMappingURL=main.b209571f.chunk.js.map